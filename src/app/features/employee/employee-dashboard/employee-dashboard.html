<section class="card">
  <div class="max-w-5xl mx-auto space-y-12">
    <h1 class="text-4xl font-bold mb-6 border-b-2 pb-6 text-shadow-lg">
      <span class="text-sky-400">Welcome, </span>{{ user?.email }}
    </h1>
    <h2 class="text-3xl font-bold mb-10 text-center text-shadow-lg">Top Rated Products</h2>

    @if (products().length>0) {
    <div class="relative overflow-hidden rounded-xl bg-beige-darker shadow-2xl mb-20">
      <div
        class="flex transition-transform duration-700 ease-in-out"
        [style.width.%]="products().length * 100"
        [style.transform]="'translateX(-' + activeIndex() * (100 / products().length) + '%)'"
      >
        @for (product of products(); track $index) {
        <div class="w-full p-8 text-center">
          @if(product?.imageBase64?.length){
          <img
            [src]="product?.imageBase64?.[0]"
            class="h-100 w-full object-cover rounded-lg mb-4"
          />
          } @else {
          <img
            src="./../../../../assets/images/placeholder_product_dark.svg"
            alt="No image"
            class="h-100 w-full object-cover rounded-lg mb-4"
          />
          }
          <h1 class="text-2xl font-bold text-tertiary">
            {{ product.productName }}
          </h1>

          <h1 class="text-xl font-semibold text-tertiary mb-2">
            {{ product?.productSummary }}
          </h1>
          <p class="text-lg leading-relaxed mb-4">
            {{ product?.editorReview }}
          </p>

          <p class="text-slate-400 text-sm">{{ product.editorRating }} / 5</p>
        </div>
        }
      </div>

      <div class="flex justify-center gap-4 pb-6">
        @for (item of products(); track $index) {
        <button
          (click)="goTo($index)"
          class="dot"
          [class.dot-active]="$index === activeIndex()"
          aria-label="Go to slide"
        ></button>
        }
      </div>
    </div>
    } @else {
    <div class="text-lg">No products available.</div>
    }

    <h2 class="text-3xl font-bold text-tertiary mb-10 text-left text-shadow-lg">All Products</h2>
    @if(products().length>0){
    <div class="grid gap-8 md:grid-cols-3 mb-14">
      @for (product of products(); track $index) {
      <div
        class="bg-beige-lighter shadow-2xl rounded-xl p-6 text-center cursor-pointer border border-beige-lighter hover:border-sky-500 transition"
        (click)="navigateToProductPage(product)"
      >
        @if(product?.imageBase64?.length){
        <img [src]="product?.imageBase64?.[0]" class="h-48 w-full object-cover rounded-lg mb-4" />
        } @else {
        <img
          src="./../../../../assets/images/placeholder_product_dark.svg"
          alt="No image"
          class="h-48 w-full object-cover rounded-lg mb-4"
        />
        }
        <h3 class="font-semibold mb-3">{{ product?.productName }}</h3>
        <h5 class="font-semibold mb-3">{{ product?.productSummary }}</h5>
        <!-- <div class="text-yellow-400 text-lg my-2">★★★★☆</div> -->
        <!-- <p class="text-slate-400 text-sm">{{ product?.userRating }} / 5</p> -->
        <p class="text-slate-400 text-sm">
          <!-- {{ product?.userRating }} <span class="text-lg">★</span> ({{ product.totalUsersRated }}
          reviews) -->
          {{ product?.editorRating }} <span class="text-lg text-yellow-400">★</span>
        </p>
      </div>
      }
    </div>
    } @else {
    <div class="text-lg">No products available.</div>
    }
  </div>
</section>
<app-status-modal #modal />
